<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ダイヤル駅名表示</title>
</head>
<body>
<script>
// ========================
// CSSスタイルをJSで作成
// ========================
const style = document.createElement("style");
style.textContent = `
  body {
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
    background-color: #f0f0f0;
  }
  h2 {
    margin-bottom: 40px;
    font-size: 28px;
    color: #333;
  }
  #dial {
    width: 200px;
    height: 200px;
    background: linear-gradient(145deg, #ddd, #bbb);
    border-radius: 50%;
    box-shadow: 5px 5px 15px rgba(0,0,0,0.2);
    position: relative;
    cursor: pointer;
  }
  #pointer {
    width: 6px;
    height: 90px;
    background: red;
    position: absolute;
    top: 20px;
    left: 50%;
    transform-origin: bottom center;
    border-radius: 3px;
  }
  #text {
    margin-top: 50px;
    font-size: 48px;
    font-weight: bold;
    color: #222;
    text-align: center;
  }
`;
document.head.appendChild(style);

// ========================
// HTML要素をJSで生成
// ========================
const heading = document.createElement("h2");
heading.textContent = "ダイヤルで駅名を表示";
document.body.appendChild(heading);

const dial = document.createElement("div");
dial.id = "dial";
document.body.appendChild(dial);

const pointer = document.createElement("div");
pointer.id = "pointer";
dial.appendChild(pointer);

const text = document.createElement("div");
text.id = "text";
text.textContent = "西唐津";
document.body.appendChild(text);

// ========================
// 駅名リスト
// ========================
const labels = [
  "西唐津",
  "唐津",
  "筑前深江",
  "筑前前原",
  "姪浜",
  "西新",
  "博多",
  "福岡空港",
  "中洲川端",
  "貝塚"
];

// ========================
// ダイヤル操作
// ========================
let isDragging = false;

dial.addEventListener("mousedown", () => { isDragging = true; });
document.addEventListener("mouseup", () => { isDragging = false; });
dial.addEventListener("mousemove", (e) => {
  if (!isDragging) return;
  const rect = dial.getBoundingClientRect();
  const x = e.clientX - (rect.left + rect.width / 2);
  const y = e.clientY - (rect.top + rect.height / 2);
  const angle = Math.atan2(y, x) * (180 / Math.PI) + 90;
  const fixedAngle = (angle + 360) % 360;
  pointer.style.transform = `rotate(${fixedAngle}deg)`;
  const index = Math.floor(fixedAngle / 36);
  text.textContent = labels[index];
});

// タッチ対応
dial.addEventListener("touchstart", () => { isDragging = true; });
document.addEventListener("touchend", () => { isDragging = false; });
dial.addEventListener("touchmove", (e) => {
  if (!isDragging) return;
  const touch = e.touches[0];
  const rect = dial.getBoundingClientRect();
  const x = touch.clientX - (rect.left + rect.width / 2);
  const y = touch.clientY - (rect.top + rect.height / 2);
  const angle = Math.atan2(y, x) * (180 / Math.PI) + 90;
  const fixedAngle = (angle + 360) % 360;
  pointer.style.transform = `rotate(${fixedAngle}deg)`;
  const index = Math.floor(fixedAngle / 36);
  text.textContent = labels[index];
  e.preventDefault();
});
</script>
</body>
</html>
