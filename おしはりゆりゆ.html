<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»®æƒ³é€šè²¨ ã‚¹ãƒ©ã‚¤ãƒ‰æ±ºæ¸ˆã”ã£ã“ (ã‚«ãƒ¼ãƒ‰)</title>
    <style>
        /* å…¨ä½“ã®è¨­å®š */
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f8ff;
            font-family: 'Meiryo', 'Arial', sans-serif;
        }

        /* æ±ºæ¸ˆç”»é¢ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        .payment-screen {
            background-color: #ffffff;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            width: 300px;
        }

        /* é‡‘é¡ã¨é€šè²¨ã®è¡¨ç¤º */
        .info-box {
            background-color: #e6f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        #amount-display {
            font-size: 2.2em;
            color: #d90000;
            font-weight: bold;
            margin: 5px 0;
        }
        #balance-display {
            font-size: 1.1em;
            color: #555;
            margin-top: 10px;
        }

        /* ã‚¹ãƒ©ã‚¤ãƒ‰ã§ä½¿ã†ã‚³ãƒ³ãƒ†ãƒŠ */
        #slider-container {
            width: 100%;
            height: 50px;
            background-color: #e0e0e0;
            border-radius: 25px;
            overflow: hidden; /* ä¸­èº«ãŒã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã« */
            position: relative;
            margin: 20px 0;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
        }

        /* ã‚¹ãƒ©ã‚¤ãƒ‰ã•ã›ã‚‹ã€Œä½¿ç”¨ã™ã‚‹ã€ãƒœã‚¿ãƒ³ */
        #slider-handle {
            width: 50px;
            height: 50px;
            background-color: #007bff;
            border-radius: 50%;
            position: absolute;
            left: 0;
            top: 0;
            cursor: grab; /* ãƒ‰ãƒ©ãƒƒã‚°ã§ãã‚‹ã‚«ãƒ¼ã‚½ãƒ« */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5em;
            transition: left 0.1s ease-out; /* æˆ»ã‚‹æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            z-index: 10;
        }

        /* ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¨ãƒªã‚¢ã®ãƒ†ã‚­ã‚¹ãƒˆ */
        #slider-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #555;
            font-weight: bold;
            letter-spacing: 1px;
            z-index: 5;
        }

        /* ã‚«ãƒ¼ãƒ‰ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆè¡¨ç¤ºç”¨ï¼‰ */
        #card-icon {
            font-size: 4em;
            color: #444;
            margin: 15px 0;
        }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        #message-area {
            margin-top: 20px;
            font-size: 1.2em;
            height: 30px;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>

    <div class="payment-screen">
        <p style="font-size: 1.4em; color: #0056b3;">ä»®æƒ³é€šè²¨ã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆ</p>

        <div class="info-box">
            <p style="margin: 0; font-size: 0.9em;">ãŠæ”¯æ‰•ã„(JPY):</p>
            <div id="amount-display">500å††</div>
            <div id="balance-display">æ®‹é«˜: <span id="current-coin">100.0</span> MC (ãƒã‚¸ãƒƒã‚¯ã‚³ã‚¤ãƒ³)</div>
        </div>
        
        <div id="card-icon">
            <span role="img" aria-label="Credit Card">ğŸ’³</span>
        </div>

        <div id="slider-container">
            <div id="slider-text">â†’ ã‚¹ãƒ©ã‚¤ãƒ‰ã—ã¦æ±ºæ¸ˆ</div>
            <div id="slider-handle">â†’</div>
        </div>

        <p id="message-area">ã‚¹ãƒ©ã‚¤ãƒ‰ã—ã¦æ±ºæ¸ˆã‚’ç¢ºå®šã—ã¦ãã ã•ã„</p>
    </div>

    <script>
        // JavaScriptã§ã‚¹ãƒ©ã‚¤ãƒ‰ã¨æ±ºæ¸ˆã®å‹•ä½œã‚’åˆ¶å¾¡ã—ã¾ã™
        var currentCoin = 100.0; // åˆæœŸæ®‹é«˜ï¼ˆãƒã‚¸ãƒƒã‚¯ã‚³ã‚¤ãƒ³ï¼‰
        var paymentYen = 500;    // æ”¯æ‰•ã„é‡‘é¡ï¼ˆå††ï¼‰
        var conversionRate = 10; // 1 MC = 10å†† ã¨ä»®å®š
        var coinToDeduct = paymentYen / conversionRate; // 50.0 MC

        var sliderContainer = document.getElementById('slider-container');
        var sliderHandle = document.getElementById('slider-handle');
        var messageArea = document.getElementById('message-area');
        var balanceDisplay = document.getElementById('current-coin');
        
        var isDragging = false;
        var startX = 0;
        var containerWidth = sliderContainer.offsetWidth;
        var handleWidth = sliderHandle.offsetWidth;
        var maxSlide = containerWidth - handleWidth;
        var isProcessing = false;
        
        // --- æ±ºæ¸ˆå®Ÿè¡Œé–¢æ•° ---
        function executePayment() {
            if (isProcessing) return;
            isProcessing = true;
            
            // å‡¦ç†é–‹å§‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            messageArea.textContent = 'å‡¦ç†ä¸­... (ä»®æƒ³é€šè²¨ã‚’å††ã«ä¸¡æ›¿)';
            messageArea.style.color = '#ff9900';

            // ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¨ãƒªã‚¢ã‚’ä¸€æ™‚çš„ã«ãƒ­ãƒƒã‚¯
            sliderHandle.style.cursor = 'default';
            sliderHandle.textContent = '...';

            // æ±ºæ¸ˆå‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            setTimeout(function() {
                if (currentCoin >= coinToDeduct) {
                    // æ±ºæ¸ˆæˆåŠŸ
                    currentCoin = currentCoin - coinToDeduct;
                    balanceDisplay.textContent = currentCoin.toFixed(1);
                    
                    messageArea.textContent = 'âœ… ' + paymentYen + 'å†† æ±ºæ¸ˆå®Œäº†ï¼';
                    messageArea.style.color = 'green';
                    sliderHandle.style.backgroundColor = 'green'; // ãƒãƒ³ãƒ‰ãƒ«ã‚’ç·‘ã«
                    sliderHandle.textContent = 'OK';
                    
                } else {
                    // æ®‹é«˜ä¸è¶³
                    messageArea.textContent = 'âŒ æ®‹é«˜ä¸è¶³ã§ã™ï¼ãƒãƒ£ãƒ¼ã‚¸ã—ã¦ãã ã•ã„ã€‚';
                    messageArea.style.color = 'red';
                    sliderHandle.style.backgroundColor = 'red'; // ãƒãƒ³ãƒ‰ãƒ«ã‚’èµ¤ã«
                    sliderHandle.textContent = 'NG';
                }
                
                // æ¬¡ã®åˆ©ç”¨ã®ãŸã‚ã®ãƒªã‚»ãƒƒãƒˆ
                setTimeout(function() {
                    messageArea.textContent = 'ã‚¹ãƒ©ã‚¤ãƒ‰ã—ã¦æ±ºæ¸ˆã‚’ç¢ºå®šã—ã¦ãã ã•ã„';
                    messageArea.style.color = '#333';
                    
                    // ãƒãƒ³ãƒ‰ãƒ«ã‚’å…ƒã®ä½ç½®ã«æˆ»ã™
                    sliderHandle.style.left = '0px';
                    sliderHandle.style.backgroundColor = '#007bff';
                    sliderHandle.style.cursor = 'grab';
                    sliderHandle.textContent = 'â†’';

                    isProcessing = false;
                }, 3000);
                
            }, 1500); // 1.5ç§’å¾Œã«æ±ºæ¸ˆçµæœã‚’è¡¨ç¤º
        }
        
        // --- ãƒã‚¦ã‚¹æ“ä½œã®ãƒªã‚¹ãƒŠãƒ¼ ---
        
        // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹
        sliderHandle.addEventListener('mousedown', (e) => {
            if (isProcessing) return;
            isDragging = true;
            startX = e.clientX;
            sliderHandle.style.transition = 'none'; // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹åŒ–
        });
        
        // ãƒ‰ãƒ©ãƒƒã‚°ä¸­
        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            
            let moveX = e.clientX - startX;
            let newLeft = sliderHandle.offsetLeft + moveX;
            
            // ç¯„å›²åˆ¶é™
            newLeft = Math.max(0, Math.min(newLeft, maxSlide));
            
            sliderHandle.style.left = newLeft + 'px';
            startX = e.clientX;
            
            // æœ€å¤§ã¾ã§ã‚¹ãƒ©ã‚¤ãƒ‰ã—ãŸã‚‰æ±ºæ¸ˆã‚’å®Ÿè¡Œ
            if (newLeft >= maxSlide) {
                isDragging = false;
                executePayment();
            }
        });
        
        // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº† (æœ€å¤§ã¾ã§ã‚¹ãƒ©ã‚¤ãƒ‰ã—ãªã‹ã£ãŸå ´åˆ)
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                sliderHandle.style.transition = 'left 0.3s ease-in-out'; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«æˆ»ã™
                sliderHandle.style.left = '0px'; // å…ƒã®ä½ç½®ã«æˆ»ã™
            }
        });
        
        // ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ï¼ˆã‚¿ãƒƒãƒï¼‰æ“ä½œã¸ã®å¯¾å¿œ
        sliderHandle.addEventListener('touchstart', (e) => {
             if (isProcessing) return;
             isDragging = true;
             startX = e.touches[0].clientX;
             sliderHandle.style.transition = 'none';
        });

        document.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            
            let moveX = e.touches[0].clientX - startX;
            let newLeft = sliderHandle.offsetLeft + moveX;
            
            newLeft = Math.max(0, Math.min(newLeft, maxSlide));
            
            sliderHandle.style.left = newLeft + 'px';
            startX = e.touches[0].clientX;
            
            if (newLeft >= maxSlide) {
                isDragging = false;
                executePayment();
            }
        });

        document.addEventListener('touchend', () => {
             if (isDragging) {
                isDragging = false;
                sliderHandle.style.transition = 'left 0.3s ease-in-out';
                sliderHandle.style.left = '0px';
            }
        });

    </script>

</body>
</html>
